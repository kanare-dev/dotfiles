# Default branch name for new repositories
[init]
  defaultBranch = main

# Core Git settings
[core]
  # Use Neovim as the default editor
  editor = nvim
  # Use delta as the pager for git diff/log
  pager = delta
  # Global gitignore file location
  excludesfile = ~/.gitignore_global
  # Global hooks directory (AI commit message generation, etc.)
  hooksPath = ~/dotfiles/git/hooks

# Fetch behavior
[fetch]
  prune = true

# Pull behavior
[pull]
  rebase = true

# Rebase behavior
[rebase]
  autoStash = true
  # rebase 中にコミットが落ちた可能性を検知しやすくする
  # (対応していない Git では無視されます)
  missingCommitsCheck = error

# Push behavior
[push]
  autoSetupRemote = true

# Conflict resolution helper
[rerere]
  enabled = true

# Aliases
[alias]
  s   = status -sb
  lg  = log --oneline --graph --decorate --all
  au  = add -u
  aa  = add -A
  c   = commit
  cm  = commit -m
  d   = diff
  ds  = diff --staged
  p   = push
  # sync: fetch→(未pushコミットがあればバックアップブランチ作成)→rebase @{u}
  # - backup/<branch>-YYYYMMDD-HHMMSS を作るので、rebase で迷子になっても戻れます
  # - upstream が無い場合は案内して終了します
  sync = "!f(){ \
    git rev-parse --abbrev-ref --symbolic-full-name @{u} >/dev/null 2>&1 || { \
      echo \"No upstream. Run: git push -u origin HEAD\"; exit 1; \
    }; \
    git fetch --prune; \
    b=$(git symbolic-ref --quiet --short HEAD || echo HEAD); \
    if [ -n \"$(git rev-list --count @{u}..HEAD 2>/dev/null)\" ] && [ \"$(git rev-list --count @{u}..HEAD 2>/dev/null)\" -gt 0 ]; then \
      ts=$(date +%Y%m%d-%H%M%S); \
      git branch \"backup/${b}-${ts}\" >/dev/null 2>&1 || true; \
      echo \"Created backup branch: backup/${b}-${ts}\"; \
    fi; \
    git rebase --autostash @{u}; \
  }; f"

# Delta pager configuration (enhanced diff viewer)
[delta]
  syntax-theme = Dracula
  features = decorations
  navigate = true
  line-numbers = true

# Local-only overrides (do not commit):
# - user.name / user.email
# - work-specific settings
[include]
  path = ~/.gitconfig.local-[filter "lfs"]
	process = git-lfs filter-process
	required = true
	clean = git-lfs clean -- %f
	smudge = git-lfs smudge -- %f
[user]
	name = kanare-dev
	email = me@kanare.dev
	signingkey = ~/.ssh/id_ed25519_github.pub

# Commit signing (GitHub "Verified") via SSH keys
[gpg]
	format = ssh

[commit]
	gpgsign = true

# AI-assisted commit message generation
# commit-provider: claude or codex
# commit-model: model name for the selected provider
[ai]
  commit-provider = claude
  commit-model = haiku
